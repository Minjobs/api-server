<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MURDOO K - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏´‡πà‡∏á‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Niramit:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/home.css">
    <style>
        /* [Ï∂îÍ∞Ä] ÌîÑÎ°úÌïÑ ÏÑπÏÖò Ïä§ÌÉÄÏùº */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .user-nav {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .profile-container {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid #ffd700; /* Ïã†ÎπÑÎ°úÏö¥ Ìô©Í∏àÎπõ ÌÖåÎëêÎ¶¨ */
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
            background: rgba(255, 255, 255, 0.1);
        }

        .profile-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        #logoutBtn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #eee;
            padding: 7px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        #logoutBtn:hover {
            background: rgba(255, 70, 70, 0.2);
            border-color: #ff4444;
        }
    </style>
</head>
<body>

    <div class="magic-background">
        <div class="magic-ring ring-1"></div>
        <div class="magic-ring ring-2"></div>
        <div class="magic-ring ring-3"></div>
        <div class="magic-runes">‚ú® üîÆ üåô ‚òÄÔ∏è üåü üåÄ üïØÔ∏è üåÄ üåü ‚òÄÔ∏è üåô üîÆ ‚ú®</div>
    </div>

    <div class="container">
        <header>
            <div class="logo">‚ú® MURDOO K</div>
            <div class="user-nav">
                <div class="profile-container">
                    <img id="userProfileImg" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Profile">
                </div>
                <button id="logoutBtn" onclick="location.href='/api/auth/logout'">Î°úÍ∑∏ÏïÑÏõÉ</button>
            </div>
        </header>

        <main>
            <section class="glass-card">
                <h2>‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡πÅ‡∏´‡πà‡∏á‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤</h2>
                <p class="subtitle">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏´‡πà‡∏á‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>

                <form id="fortuneForm">
                    <div class="input-row">
                        <div class="field">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á (Real Name)</label>
                            <input type="text" id="realName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á" required>
                        </div>
                        <div class="field">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô (Nickname)</label>
                            <input type="text" id="nickName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô" required>
                        </div>
                    </div>

                    <div class="field">
                        <label>‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î (Date of Birth)</label>
                        <div class="dropdown-group dob-group">
                            <select id="birthDay" required><option value="" disabled selected>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</option></select>
                            <select id="birthMonth" required><option value="" disabled selected>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                                <option value="01">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° (Jan)</option><option value="12">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° (Dec)</option>
                            </select>
                            <select id="birthYear" required><option value="" disabled selected>‡∏õ‡∏µ (‡∏Ñ.‡∏®.)</option></select>
                        </div>
                    </div>

                    <div class="field">
                        <label>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î (Birth Time)</label>
                        <div class="dropdown-group time-group">
                            <select id="birthHour" required><option value="" disabled selected>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</option></select>
                            <select id="birthMin" required><option value="" disabled selected>‡∏ô‡∏≤‡∏ó‡∏µ</option></select>
                            <button type="button" id="unknownTimeBtn" class="unknown-btn">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤</button>
                        </div>
                    </div>

                    <div class="field">
                        <label>‡πÄ‡∏û‡∏® (Gender Identity)</label>
                        <select id="gender" required>
                            <option value="" disabled selected>ÏÑ†ÌÉù</option>
                            <option value="male">‡∏ä‡∏≤‡∏¢ (Male)</option><option value="female">‡∏´‡∏ç‡∏¥‡∏á (Female)</option>
                        </select>
                    </div>

                    <button type="submit" class="submit-btn">‡∏î‡∏π‡∏î‡∏ß‡∏á‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</button>
                </form>
            </section>
        </main>

        <footer>
            <p>¬© 2026 MURDOO K. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏´‡πà‡∏á‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏¥‡∏Ç‡∏¥‡∏ï</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const profileImg = document.getElementById('userProfileImg');
            
            // [1] Ïú†Ï†Ä Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ Ìï®Ïàò
            const initUser = async () => {
                try {
                    const res = await fetch('/api/user/me');
                    if (res.ok) {
                        const user = await res.json();
                        // ÌîÑÎ°úÌïÑ ÏÇ¨ÏßÑÏù¥ ÏûàÏúºÎ©¥ Ï†ÅÏö©, ÏóÜÏúºÎ©¥ Í∏∞Î≥∏ Ïù¥ÎØ∏ÏßÄ
                        profileImg.src = user.profile_img || '/img/default-avatar.png';
                    } else {
                        // Ïù∏Ï¶ù Ïã§Ìå® Ïãú Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄÎ°ú Í∞ïÏ†ú Ïù¥Îèô
                        window.location.href = '/login';
                    }
                } catch (err) {
                    console.error('User Load Error:', err);
                }
            };

            // Ïã§Ìñâ
            await initUser();

            // --- Í∏∞Ï°¥ Ìèº Î°úÏßÅ (ÎìúÎ°≠Îã§Ïö¥ ÏÉùÏÑ± Îì±) ---
            const form = document.getElementById('fortuneForm');
            const daySel = document.getElementById('birthDay');
            const yearSel = document.getElementById('birthYear');
            const hourSel = document.getElementById('birthHour');
            const minSel = document.getElementById('birthMin');
            const monthSel = document.getElementById('birthMonth');
            const unknownBtn = document.getElementById('unknownTimeBtn');

            let isTimeUnknown = false;

            for (let i = 1; i <= 31; i++) daySel.add(new Option(i, i < 10 ? `0${i}` : i));
            const currentYear = new Date().getFullYear();
            for (let i = currentYear; i >= 1900; i--) yearSel.add(new Option(i, i));
            for (let i = 0; i < 24; i++) hourSel.add(new Option(i < 10 ? `0${i}` : i, i < 10 ? `0${i}` : i));
            for (let i = 0; i < 60; i++) minSel.add(new Option(i < 10 ? `0${i}` : i, i < 10 ? `0${i}` : i));

            unknownBtn.addEventListener('click', () => {
                isTimeUnknown = !isTimeUnknown;
                const controls = [daySel, monthSel, yearSel, hourSel, minSel];
                if (isTimeUnknown) {
                    unknownBtn.classList.add('active');
                    controls.forEach(el => { el.selectedIndex = 0; el.disabled = true; el.style.opacity = '0.3'; });
                } else {
                    unknownBtn.classList.remove('active');
                    controls.forEach(el => { el.disabled = false; el.style.opacity = '1'; });
                }
            });

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                // ... Ìèº Ï†úÏ∂ú Î°úÏßÅ ÎèôÏùº ...
                alert('‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡∏ß‡∏á‡∏ä‡∏∞‡∏ï‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß...');
            });
        });
    </script>
</body>
</html>
