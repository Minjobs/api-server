<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡πÄ‡∏°‡∏≠‡∏£‡πå‡∏î‡∏π ‡πÄ‡∏Ñ - ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏≤‡∏¢‡∏ò‡∏á 5 ‡∏™‡∏µ</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;800&family=Nanum+Myeongjo:wght@700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        :root {
            --bg-overlay: rgba(0, 0, 0, 0.55); 
            --point-gold: #ffd700;
            --point-red: #ff4757;
            --text-white: #ffffff;
            --border-line: rgba(255, 215, 0, 0.5); 
            --glow-gold: 0 0 15px rgba(255, 215, 0, 0.6);
        }

        body {
            margin: 0; padding: 0;
            background-color: #1a1a1a; 
            font-family: 'Kanit', sans-serif;
            color: var(--text-white);
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .background-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background-image: url('/background.jpg'); 
            background-size: cover; background-position: center;
            opacity: 0.7; 
        }

        .header-logo { margin-top: 25px; margin-bottom: 20px; z-index: 10; cursor: pointer; transition: 0.3s; }
        .header-logo img { height: 40px; }
        .header-logo:active { transform: scale(0.95); }

        .container {
            width: 90%; max-width: 440px;
            background-color: var(--bg-overlay);
            border-radius: 35px;
            padding: 35px 20px 45px 20px;
            box-sizing: border-box;
            backdrop-filter: blur(10px); 
            border: 2px solid var(--border-line);
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        .intro-text h1 { 
            font-family: 'Nanum Myeongjo', serif; 
            font-size: 1.9rem; color: var(--point-gold); 
            text-shadow: var(--glow-gold); margin: 0 0 10px 0; 
        }
        .intro-text p { font-size: 0.95rem; opacity: 0.9; font-weight: 300; line-height: 1.6; margin: 0 0 15px 0; }

        .stage-wrapper {
            min-height: 280px; 
            display: flex; flex-direction: column; 
            justify-content: center; align-items: center;
            position: relative;
            margin: 20px auto;
            width: 100%;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 20px;
        }

        .flag-rows {
            display: flex; flex-direction: column; gap: 15px; 
            align-items: center;
            width: 100%;
        }

        .flag-row {
            display: flex; justify-content: center; gap: 20px; 
            width: 100%;
        }

        .flag-img {
            width: 90px; 
            height: auto;
            filter: drop-shadow(0 5px 8px rgba(0,0,0,0.5));
            transition: transform 0.3s ease;
            position: relative; 
        }

        .shaking .flag-img {
            animation: shake-flag 0.2s infinite ease-in-out alternate;
        }
        
        .shaking .flag-img:nth-child(odd) { animation-delay: 0s; }
        .shaking .flag-img:nth-child(even) { animation-delay: 0.1s; }

        @keyframes shake-flag {
            0% { transform: rotate(-5deg) translateY(0); }
            100% { transform: rotate(5deg) translateY(-2px); }
        }

        #result-display {
            display: none;
            flex-direction: column; align-items: center;
            padding: 10px 0;
            animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .result-stage {
            border: 2px solid var(--point-gold);
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 25px 15px;
            margin-bottom: 25px;
            width: 100%; box-sizing: border-box;
            box-shadow: inset 0 0 20px rgba(255, 215, 0, 0.1);
        }

        .result-flag-img { 
            width: 140px; margin-bottom: 15px; 
            filter: drop-shadow(0 0 15px rgba(255,255,255,0.2));
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }

        .fate-title { font-size: 1.8rem; font-weight: 800; color: var(--point-gold); margin-bottom: 10px; line-height: 1.2; }
        .fate-desc { font-size: 1rem; font-weight: 300; line-height: 1.7; color: #eee; margin-bottom: 15px; word-break: break-word; }

        .container.bad-luck { border-color: var(--point-red); box-shadow: 0 20px 60px rgba(255, 71, 87, 0.2); }
        .bad-luck .result-stage { border-color: var(--point-red); box-shadow: inset 0 0 20px rgba(255, 71, 87, 0.2); }
        .bad-luck .fate-title { color: var(--point-red); }

        .action-btn {
            width: 85%; padding: 16px; border: none; border-radius: 40px;
            font-size: 1.2rem; font-weight: 700; cursor: pointer; font-family: 'Kanit';
            transition: all 0.2s; margin: 0 auto; display: block;
        }
        
        #shakeBtn {
            background: linear-gradient(135deg, var(--point-gold), #f57c00);
            color: #000; box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
        }
        #shakeBtn:active { transform: scale(0.96); }

        .retry-btn {
            background: transparent; border: 1px solid rgba(255,255,255,0.4); color: #ccc;
            width: auto; padding: 10px 30px; font-size: 0.95rem; display: inline-block;
        }
        .retry-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }

        .aekdaem-btn { 
            background: var(--point-red); color: white; 
            box-shadow: 0 5px 20px rgba(255, 71, 87, 0.4); margin-bottom: 15px;
        }

        .hidden { display: none !important; }
        @keyframes popIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
        
        footer { text-align: center; margin-top: 25px; color: rgba(255,255,255,0.3); font-size: 0.75rem; }
    </style>
</head>
<body>

    <div class="background-overlay"></div>

    <audio id="sfx-shake" src="/sound/shake.mp3" loop></audio>
    <audio id="sfx-result" src="/sound/result.mp3"></audio>

    <header class="header-logo" onclick="location.href='/'">
        <img src="/textlogo.png" alt="‡πÄ‡∏°‡∏≠‡∏£‡πå‡∏î‡∏π ‡πÄ‡∏Ñ">
    </header>

    <main class="container">
        
        <div id="ritual-view">
            <div class="intro-text">
                <h1>‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏≤‡∏¢‡∏ò‡∏á 5 ‡∏™‡∏µ</h1>
                <p>‡∏ï‡∏±‡πâ‡∏á‡∏à‡∏¥‡∏ï‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô‡∏ñ‡∏∂‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÉ‡∏à<br>‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡∏ò‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ä‡∏µ‡πâ‡πÅ‡∏ô‡∏∞‡∏à‡∏≤‡∏Å‡πÄ‡∏ó‡∏û‡πÄ‡∏à‡πâ‡∏≤</p>
            </div>

            <div class="stage-wrapper" id="stage">
                <div class="flag-rows">
                    <div class="flag-row">
                        <img src="/flag/flag_red.png" class="flag-img" alt="‡∏™‡∏µ‡πÅ‡∏î‡∏á">
                        <img src="/flag/flag_white.png" class="flag-img" alt="‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß">
                        <img src="/flag/flag_yellow.png" class="flag-img" alt="‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á">
                    </div>
                    <div class="flag-row">
                        <img src="/flag/flag_blue.png" class="flag-img" alt="‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô">
                        <img src="/flag/flag_black.png" class="flag-img" alt="‡∏™‡∏µ‡∏î‡∏≥">
                    </div>
                </div>
            </div>

            <button id="shakeBtn" class="action-btn" onclick="startRitual()">‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡∏ò‡∏á</button>
        </div>

        <div id="result-display">
            <div class="result-stage">
                <img src="" id="resImg" class="result-flag-img">
                <div class="fate-title" id="resTitle"></div>
                <div class="fate-desc" id="resDesc"></div>
            </div>
            
            <div id="btn-group-normal">
                <button class="action-btn retry-btn" onclick="resetAndReload()">‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
            </div>

            <div id="btn-group-bad" style="display:none;">
                <button class="action-btn aekdaem-btn" onclick="doAekDaem()">‡∏™‡∏∞‡πÄ‡∏î‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
                <button class="action-btn retry-btn" style="border: none;" onclick="closeResultView()">‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢</button>
            </div>
        </div>

    </main>

    <footer>¬© 2026 ‡πÄ‡∏°‡∏≠‡∏£‡πå‡∏î‡∏π ‡πÄ‡∏Ñ. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏´‡πà‡∏á‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß</footer>

    <script>
        const flags = [
            { 
                src: '/flag/flag_red.png', 
                status: 'üö© ‡∏ò‡∏á‡πÅ‡∏î‡∏á: ‡∏°‡∏´‡∏≤‡πÇ‡∏ä‡∏Ñ', 
                desc: '‡∏î‡∏ß‡∏á‡πÄ‡∏õ‡∏¥‡∏î ‡∏ü‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î! ‡∏™‡∏¥‡πà‡∏á‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ‡∏û‡∏£‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ß‡∏±‡∏á‡πÑ‡∏ß‡πâ‡∏à‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏≤‡∏è‡∏¥‡∏´‡∏≤‡∏£‡∏¥‡∏¢‡πå ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏ï‡∏±‡∏ß ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤ ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏°‡πà‡πÜ ‡∏•‡∏∏‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!',
                isBad: false
            },
            { 
                src: '/flag/flag_white.png', 
                status: 'üè≥Ô∏è ‡∏ò‡∏á‡∏Ç‡∏≤‡∏ß: ‡πÄ‡∏ó‡∏û‡∏£‡∏±‡∏Å‡∏©‡∏≤', 
                desc: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à‡∏à‡∏∞‡∏ä‡∏ô‡∏∞‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡πà‡∏á! ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î‡∏à‡∏∞‡∏Ñ‡∏•‡∏µ‡πà‡∏Ñ‡∏•‡∏≤‡∏¢‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏¢‡∏Å‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏≠‡∏Å ‡∏à‡∏∞‡∏°‡∏µ "‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÉ‡∏à‡∏î‡∏µ" ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏±‡∏•‡∏¢‡∏≤‡∏ì‡∏°‡∏¥‡∏ï‡∏£‡∏¢‡∏∑‡πà‡∏ô‡∏°‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏±‡πà‡∏ô‡∏™‡∏ß‡∏î‡∏°‡∏ô‡∏ï‡πå‡πÑ‡∏´‡∏ß‡πâ‡∏û‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏∞‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå',
                isBad: false
            },
            { 
                src: '/flag/flag_yellow.png', 
                status: 'üü° ‡∏ò‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á: ‡∏•‡∏≤‡∏†‡∏ö‡∏£‡∏£‡∏û‡∏ä‡∏ô', 
                desc: '‡∏ö‡∏£‡∏£‡∏û‡∏ö‡∏∏‡∏£‡∏∏‡∏©‡πÅ‡∏•‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏ó‡∏≤‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏°‡∏≠‡∏á‡∏î‡∏π‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà! ‡∏ó‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏´‡∏ß‡∏±‡∏á ‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç‡∏≠‡∏∏‡∏ó‡∏¥‡∏®‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏∏‡∏®‡∏•‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏á ‡∏•‡∏≠‡∏á‡∏ñ‡∏ß‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏ß‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç‡πÇ‡∏•‡∏á‡∏®‡∏û ‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†‡πÅ‡∏ö‡∏ö‡∏ü‡∏•‡∏∏‡πä‡∏Ñ‡πÜ ‡∏à‡∏∞‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏±‡∏ô‡∏ó‡∏µ',
                isBad: false
            },
            { 
                src: '/flag/flag_blue.png', 
                status: 'üîµ ‡∏ò‡∏á‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô: ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏•‡∏°‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô', 
                desc: '‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡πÜ ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞! ‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ß‡πâ‡∏≤‡∏ß‡∏∏‡πà‡∏ô ‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÉ‡∏à ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏•/‡πÇ‡∏¢‡∏Å‡∏¢‡πâ‡∏≤‡∏¢‡∏Å‡∏∞‡∏ó‡∏±‡∏ô‡∏´‡∏±‡∏ô ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏ç‡πà‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏≤‡∏¢‡∏∏‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô',
                isBad: false 
            },
            { 
                src: '/flag/flag_black.png', 
                status: 'üè¥ ‡∏ò‡∏á‡∏î‡∏≥: ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢!', 
                desc: '‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏ô‡∏µ‡πâ! ‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏£‡∏á‡πÜ ‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á! ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏î‡∏µ‡πÄ‡∏•‡∏¢ ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÇ‡∏î‡∏ô‡∏´‡∏•‡∏≠‡∏Å ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏ó‡∏≥‡∏ö‡∏∏‡∏ç‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏õ‡∏•‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ‡∏ó‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÄ‡∏Ñ‡∏•‡πá‡∏î (‡∏™‡∏∞‡πÄ‡∏î‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå) ‡πÇ‡∏î‡∏¢‡∏î‡πà‡∏ß‡∏ô',
                isBad: true 
            }
        ];

        // ‚úÖ [ÌôïÎ•† Î≥¥Ï†ï] Îç± ÏãúÏä§ÌÖú (Bag System) Î≥ÄÏàò Ï∂îÍ∞Ä
        // 5Í∞ú Ï§ë ÌïòÎÇòÏî© ÎΩëÏïÑ Ïì∞Îã§Í∞Ä Îã§ Ïì∞Î©¥ Îã§Ïãú Ï±ÑÏö∞Îäî Î∞©Ïãù
        let flagPool = [];

        const shakeBtn = document.getElementById('shakeBtn');
        const stage = document.getElementById('stage');
        const ritualView = document.getElementById('ritual-view');
        const resultDisplay = document.getElementById('result-display');
        
        const sfxShake = document.getElementById('sfx-shake');
        const sfxResult = document.getElementById('sfx-result');

        let isShaking = false;

        // ‚úÖ Îç± Ï¥àÍ∏∞Ìôî Î∞è ÏÖîÌîå Ìï®Ïàò
        function fillFlagPool() {
            flagPool = [0, 1, 2, 3, 4]; // 5Í∞ú Ïù∏Îç±Ïä§ Ï∂©Ï†Ñ
            // ÌîºÏÖî-ÏòàÏù¥Ï∏† ÏÖîÌîå (ÎûúÎç§ ÏÑûÍ∏∞)
            for (let i = flagPool.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [flagPool[i], flagPool[j]] = [flagPool[j], flagPool[i]];
            }
        }

        // ‚úÖ Í≥µÏ†ïÌïú ÎûúÎç§ ÎΩëÍ∏∞ Ìï®Ïàò (20% ÌôïÎ•† Î≥¥Ïû•)
        function getFairFlag() {
            if (flagPool.length === 0) {
                fillFlagPool();
            }
            const index = flagPool.pop(); // ÌïòÎÇò Í∫ºÎÇ¥Í∏∞
            return flags[index];
        }

        function startRitual() {
            if (isShaking) return;
            isShaking = true;

            shakeBtn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£...";
            shakeBtn.disabled = true;
            stage.classList.add('shaking'); 

            if (navigator.vibrate) navigator.vibrate([100, 100, 100, 100, 200]); 
            try { sfxShake.play().catch(() => {}); } catch(e){}

            setTimeout(() => {
                stopRitual();
            }, 2500);
        }

        function stopRitual() {
            stage.classList.remove('shaking');
            try { 
                sfxShake.pause(); 
                sfxShake.currentTime = 0;
                sfxResult.play().catch(() => {}); 
            } catch(e){}

            // ‚úÖ Í∏∞Ï°¥ Math.random() ÎåÄÏã† Î≥¥Ï†ïÎêú Ìï®Ïàò ÏÇ¨Ïö©
            const result = getFairFlag();
            showResult(result);

            shakeBtn.disabled = false;
            isShaking = false;
        }

        function showResult(data) {
            ritualView.classList.add('hidden');
            resultDisplay.style.display = 'flex';

            document.getElementById('resImg').src = data.src;
            document.getElementById('resTitle').innerText = data.status;
            document.getElementById('resDesc').innerText = data.desc;

            const mainContainer = document.querySelector('.container');
            if (data.isBad) {
                mainContainer.classList.add('bad-luck');
                document.getElementById('btn-group-normal').style.display = 'none';
                document.getElementById('btn-group-bad').style.display = 'block';
                if (navigator.vibrate) navigator.vibrate(500); 
            } else {
                mainContainer.classList.remove('bad-luck');
                document.getElementById('btn-group-normal').style.display = 'block';
                document.getElementById('btn-group-bad').style.display = 'none';
            }
        }

        function closeResultView() {
            const mainContainer = document.querySelector('.container');
            mainContainer.classList.remove('bad-luck');
            resultDisplay.style.display = 'none';
            ritualView.classList.remove('hidden');
            shakeBtn.innerText = "‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡∏ò‡∏á"; 
        }

        function resetAndReload() {
            location.reload();
        }

        function doAekDaem() {
            Swal.fire({
                title: '‡∏™‡∏∞‡πÄ‡∏î‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                html: '‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏Ç‡∏°‡∏≤‡∏ï‡πà‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏•‡πâ‡∏ß<br>‡∏£‡πâ‡∏≤‡∏¢‡∏à‡∏∞‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏µ ‡∏´‡∏ô‡∏±‡∏Å‡∏à‡∏∞‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ö‡∏≤',
                icon: 'success',
                confirmButtonText: '‡∏™‡∏≤‡∏ò‡∏∏', 
                confirmButtonColor: '#ff4757',
                background: '#1a1a1a',
                color: '#fff',
                customClass: { popup: 'swal-custom' }
            }).then(() => {
                closeResultView();
            });
        }
    </script>
</body>
</html>
